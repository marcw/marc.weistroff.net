
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Another brain on earth</title>
  <meta name="author" content="Marc Weistroff">

  
  <meta name="description" content="Last year, I started what I would like to become a personal tradition. I
decided to create a playlist that would describe my prominent emotions of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://marc.weistroff.net">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed.atom" rel="alternate" title="Another brain on earth" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed.atom" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:marc.weistroff.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="http://www.delatech.nl">Hire me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2015/01/14/2014-in-music/">2014, My Retrospective in Music</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-14T00:00:00+01:00" pubdate data-updated="true">Jan 14<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last year, I started what I would like to become a personal tradition. I
decided to create a playlist that would describe my prominent emotions of the
year that just passed. The creative process would be a way for me to look back
at the year, both emotionaly and musically. I was afraid though that it would
be an endless process and that I would end up putting up an endless collection
of tracks without any meaning. I needed some limitations.</p>

<p>I always liked the length limitation of vinyls. Back in the days, album were
also designed with that limit in mind and you could really feel how it
influenced the construction of the album. The original <a href="http://en.wikipedia.org/wiki/LP_record">LP
record</a> had a maximum playing time of
nearly 45 minutes, or 22 minutes by side. I decided to take this restriction
and to add another one: Only 4 tracks by side.</p>

<p>These constaints gave me a framework which enabled me to focus myself on the
most important phases I went through during the year. I added a soft constraint
as well: Tracks should be the one I listened to during this year.</p>

<p>Without further ado, here is my 2014 retrospective.</p>

<p>2014 retrospective: &ldquo;Mont-Royal LP&rdquo;</p>

<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/69280668%3Fsecret_token%3Ds-aA2ko&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;visual=true"></iframe>


<p>Side 1:</p>

<ul>
<li>Pachanga Boys &ndash; Black Naga (Hippie Dance)</li>
<li><a href="http://www.polaarsounds.com/releases/flore-ritual-part-1.html">Flore &ndash; Numen (POLAAR)</a></li>
<li>Suuns &ndash; Music won&rsquo;t save you (Secretly Canadian)</li>
<li>Kool &amp; The Gang &ndash; Summer Madness (Polygram)</li>
</ul>


<p>Side 2:</p>

<ul>
<li><a href="http://www.polaarsounds.com/releases/flore-ritual-part-1.html">Flore &ndash; Random (POLAAR)</a></li>
<li>Parquet Courts &ndash; Ducking &amp; Dodging (What&rsquo;s Your Rupture?)</li>
<li>Run The Jewels &ndash; Love Again (Akinyele Back) (feat. Gangsta Boo) (Mass Appeal)</li>
<li>The Beatles &ndash; Tomorrow Never Knows (Parlophone)</li>
</ul>


<p>The <a href="https://soundcloud.com/marcw/sets/lapsane-2013/s-3EG1M">2013 retrospective is still available on
SoundCloud</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2015/01/07/">Speechless</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-07T00:00:00+01:00" pubdate data-updated="true">Jan 7<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img width="100%" height="300px" src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/12/04/inspirations/">2014&#8217;s Inspirations</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-04T00:00:00+01:00" pubdate data-updated="true">Dec 4<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Well the year isn&rsquo;t over yet but I wanted to write down what inspired me in the
past 12 months. Like you, I’m always looking around for interesting work to
nourish my mind. Sign of times, I haven’t read many books. It’s been mostly an
audio/video year. I watched a hell lot of TV though. Netflix doesn’t help in
that matter&hellip; I’ve had a huge interest in comedy. I discovered the american
alt-comedy scene and have been struck by their creativity and blunt thoughts.</p>

<h2>Stand-Up specials</h2>

<ul>
<li><a href="http://www.reggiewatts.com/">Reggie Watts</a> &ndash; <a href="http://www.rottentomatoes.com/m/reggie_watts_why_shit_so_crazy/">Why Shit So
Crazy</a></li>
<li><a href="http://en.wikipedia.org/wiki/Sarah_Silverman">Sarah Silverman</a> &ndash; <a href="http://www.imdb.com/title/tt2883224/">We Are
Miracles</a></li>
<li><a href="http://www.wtfpod.com/">Marc Maron</a> &ndash; <a href="http://www.imdb.com/media/rm326552064/tt3004634?ref_=tt_ov_i">Thinky
Pain</a></li>
<li><a href="https://www.louisck.net/">Louis CK</a> &ndash; <a href="https://www.louisck.net/purchase/oh-my-god">Oh My
God</a></li>
</ul>


<iframe width="560" height="315" src="//www.youtube-nocookie.com/embed/mPCPxNnoU3M" frameborder="0" allowfullscreen></iframe>


<h2>TV Shows</h2>

<p>Once again, comedy was a central theme in my choices. I stopped watching other
shows that I won&rsquo;t name here.</p>

<ul>
<li><a href="http://www.imdb.com/title/tt0387764/">Peep Show</a></li>
<li><a href="http://www.imdb.com/title/tt1492966/">Louie</a></li>
<li><a href="http://www.imdb.com/title/tt2520512/">Maron</a></li>
<li><a href="http://www.imdb.com/title/tt0193676/">Freaks and Geeks</a></li>
<li><a href="http://en.wikipedia.org/wiki/Mad_Men">Mad Men</a></li>
</ul>


<h2>Movies</h2>

<p>I watched other great movies than those present in this list, but I prefer to
keep it short.</p>

<ul>
<li><a href="http://www.imdb.com/title/tt2358891/">La Grande Bellezza</a></li>
<li><a href="http://www.imdb.com/title/tt1935156/">Jodorowsky&rsquo;s Dune</a></li>
</ul>


<p><img src="/images/la_grande_bellezza.jpg" alt="La Grande Bellezza" /></p>

<h2>Music</h2>

<p>This year was really interesting on the music side. I started buying vinyls
again and went back to my turntables. I discovered really good house and techno
tracks, but in the end I prefer to list these indie bands.</p>

<ul>
<li><a href="http://wearetheacid.com/">The Acid</a></li>
<li><a href="http://www.djangodjango.co.uk/">Django Django</a></li>
<li><a href="http://parquetcourts.wordpress.com/">Parquet Courts</a></li>
<li><a href="https://wearenothing.bandcamp.com">Nothing</a></li>
</ul>


<iframe width="560" height="315" src="//www.youtube-nocookie.com/embed/xvmhhNiGZr0" frameborder="0" allowfullscreen></iframe>


<h2>Club Night</h2>

<p><a href="http://www.laurentgarnier.com/">Laurent Garnier</a> at <a href="http://www.stereonightclub.net/">Stereo Night
Club</a> in Montreal. This club has the best
sound system. Period. Forget the clinical coldness of a <a href="http://www.funktion-one.com/">Funktion
One</a> system. This one has a warm and beautiful
sound. Laurent Garnier did a good set, sticking perfectly to the club’s
atmosphere.</p>

<h2>Books</h2>

<p>I haven&rsquo;t read much. Or not as much as I&rsquo;d like. Or maybe too much. My whole
days are spent reading stuff. Be it code, articles, emails, social medias. At
the end of the day, I much prefer watching and listening than reading</p>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Blankets_%28comics%29">Blankets</a> by Craig
Thompson</li>
</ul>


<h2>Exhibitions</h2>

<ul>
<li><a href="http://portlandartmuseum.org/exhibitions/enclave/">The Enclave</a> by
photographer <a href="http://www.richardmosse.com/">Richard Mosse</a> at  FOAM.</li>
<li><a href="http://www.stedelijk.nl/en/exhibitions/marcel-wanders-pinned-up-at-the-stedelijk">Marcel Wenders: Pinned
Up</a>
at Stedelijk Museum.</li>
</ul>


<p><img src="/images/the-enclave.jpg" alt="The Enclave" /></p>

<p>Does this post need a conclusion? Naaah. You&rsquo;ll do fine without.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/23/in-the-last-24-months/">In the Last 24 Months</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-23T00:00:00+02:00" pubdate data-updated="true">Aug 23<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The last time I wrote something here was in 2012. What happened since then?
It&rsquo;s been quite a ride actually. I lived in 3 different cities on two
continents and had some realizations on the way I want to work and the
importance it had on my life.</p>

<p>If you (still) follow me on twitter, you might have seen some changes. I&rsquo;m
tweeting more and more in French and less and less about technologies. It
didn&rsquo;t <a href="https://twitter.com/clochix/status/491868477658267648">went unnoticed to
@clochix</a> and he asked
me what I was doing and if there was a chance that I could wrote about that
somewhere.</p>

<p>In the last 24 months, I left Paris and lived in Montreal, Berlin and now
Amsterdam. I met a whole bunch of people, made new friends along the way and
basically hadn&rsquo;t too much to worry about because as I often say to people I
meet &ldquo;when you&rsquo;re a developer, you can basically work from anywhere&rdquo;. The
freedom you get by doing that has its obvious drawbacks, but the upsides are
really fun.</p>

<p>In the last 24 months, my views on work changed as well. As I was reading on
autonomy and independence, I realized that being an employee was unsatisfying
to me. It has its good sides but it was mostly frustrating in the end. I
decided to become a freelancer. Who doesn&rsquo;t need some php/symfony2/golang
expertise in this world right now? Of course, there&rsquo;s more to that: I wanted to
create something from my hands and my brain. This is something incredibly hard
to do when you&rsquo;re in an office for 5 days a week and that you also happen to
enjoy your evenings and your weekends. Freelancing gives me the possibility to
balance my workload between my clients and my projects. With freelancing, I can
confront my classic gen-x/gen-y developer bullshit to the real world. And I
can&rsquo;t really tell you how good it is. In times where offices are transformed
into playgrounds and that your company is paying for your breakfasts and your
friday booze, trying to accomplish something by yourself can be seen as mad.
Why would you refuse all these privileges? I don&rsquo;t really know, but I just had
to the feeling that I should do it.</p>

<p>In the last 24 months, I must admit I lost interest in the IT industry. I
could state a lot of reasons for that but it would raise endless debates
because none of us would be right or wrong. The fact is that I can get bored
quickly when things look and act the same. This industry has bored me. I&rsquo;ll get
more involved again when the monoculture is less strong.</p>

<p>I tried to build (alone) different products but somehow always failed
developing them past a certain point. This is something utterly frustrating.
Luckily during the Symfony Live 2013 in Berlin, I had the chance to have a few
conversations with <a href="https://twitter.com/dustinwhittle">Dustin Whittle</a>, <a href="https://twitter.com/fabpot">Fabien
Potencier</a> and <a href="https://twitter.com/francoisz">Francois
Zaninotto</a> who gave me really good advices:
&ldquo;Don&rsquo;t create a business alone&rdquo;, &ldquo;It&rsquo;s harder than you think, but rewarding&rdquo;,
&ldquo;Think of the future of your product and how it will evolve&rdquo;, and &ldquo;expose your
projects to like-minded people&rdquo;.</p>

<p>Now the funny thing in life is that if you give room for surprises to happen,
they might actually do. At the beginning of the year, a conversation with my
good friend <a href="https://twitter.com/FloreMusic">Flore</a> led to something like that
(jokes, usual stupidity and facebook stickers removed for clarity).</p>

<ul>
<li> Her: &ldquo;I think I want to start a record label, but it&rsquo;s tough&rdquo;</li>
<li> Me: &ldquo;I never told you that but I have this idea in my mind since quite a while now.&rdquo;</li>
<li> Her: &ldquo;Well it would be fun to do that together. We should think about that maybe&hellip;&rdquo;</li>
<li> Me: &ldquo;Yeah, let&rsquo;s think about it&rdquo;</li>
</ul>


<p>A few weeks later, it was on. We were creating a <a href="http://polaarsounds.com">record
label</a>. This is a new adventure and even if I&rsquo;m
clearly out of my comfort zone, I enjoy it more and more. Music is my passion
and I&rsquo;m glad I can see tech not as an end, but as a mean. I often asked myself
who would create a time-consuming small business in the worst industry to do
business at this time? The only answer I got is &ldquo;Maybe the same guy who doesn&rsquo;t
like his office to look like a playground.&rdquo;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/12/15/why-i-stopped-self-hosting-my-stuffs/">Why I Stopped Self-hosting My Mails, IM and Website</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-15T00:00:00+01:00" pubdate data-updated="true">Dec 15<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A year ago, I started an experiment. I wanted to quit gmail and gtalk services
and prove me that I could host my emails and my IM myself.  It went quite well
but I decided to stop and subscribed to <a href="http://fastmail.fm">fastmail.fm</a> and
to <a href="http://hosted.im">hosted.im</a>.</p>

<h2>Installation</h2>

<p>A year ago, I spent some days installing a fully functionnal mail/web/jabber
server. Hopefully, I had some <a href="http://flurdy.com/docs/postfix/">good tutorials</a>
about setting up a mail server. On the jabber side, it was quite easy even if
sometime, my WTF-o-meter level was really high. I blame my totally absent
knowledge of erlang and mnesia here.</p>

<p>The easiest part was to set-up varnish and nginx on the server.  This is
because I use these technologies every day. I still think that serving static
files with a reverse proxy could be much more easier and quicker to setup.</p>

<p>Backuping is easy and cheap, thanks to Amazon S3. I did not suffer any crash
and did not have to restore my data. I think I would have cried if I had to do
that because of the time needed to set-up the server again.  The pain would
have been bearable thanks to the EBS (if it doesn&rsquo;t fail).</p>

<p>My final set-up used these technologies: Amazon EC2, Amazon S3, Amazon
CloudFront, Amazon Elastic Block Storage, Postfix, Dovecot, Sieve, Varnish,
Postgrey, Spamassassin, Nginx and Ejabberd.</p>

<h2>Running it</h2>

<p>Here is what I learned:</p>

<ul>
<li><p>SMTP servers obey Murphy&rsquo;s Law. If you have an important mail to send, it
will fail. Fallbacking to gmail happened too many time.</p></li>
<li><p>ejabberd is stable. In a year of operation, it failed once and restarting
it made did the trick. The <a href="http://www.process-one.net/en/">guys behind
ejabberd</a> did a really great job.</p></li>
<li><p>Spam was virtually absent from my mail. Spamassasin and postgrey worked
well.</p></li>
<li><p><a href="http://en.wikipedia.org/wiki/Sieve_%28mail_filtering_language%29">Sieve</a>
is great. I mean really really GREAT. Filtering mail in gmail is a pain.</p></li>
<li><p>Mail clients all suck. Sparrow was an exception.</p></li>
<li><p>I&rsquo;m not nerdy enough to use <a href="http://www.mutt.org/">Mutt</a>.</p></li>
<li><p>I should have used a configuration management system like Chef, Puppet or
CFEngine to create the server. It would have doubled/tripled the time
required to configure it properly, but it would have been an asset if I
wanted to migrate my services to another host, which I considered at some
point.</p></li>
</ul>


<h2>Now</h2>

<p>Yesterday, and after too many problem with my SMTP server, I decided to end
this experiment and started looking for a reliable mail provider. I chose
fastmail.fm because of the price, migrations processes and the Sieve support.</p>

<p>This website is now hosted by Amazon S3. The only cron job that I had is now
run on heroku. My jabber service is being migrated to hosted.im.</p>

<p>This will costs me around 50$ a year and this is definitely worth the time I
won&rsquo;t put in managing a server.</p>

<p>Creating, installing and configuring software is easy. Achieving reliability is
hard.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/11/23/Cross-Domain-AJAX-withCredentials/">Authenticated Cross-Domains AJAX Requests With CORS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-11-23T00:00:00+01:00" pubdate data-updated="true">Nov 23<span>rd</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday, I lost a significant amount of time dealing with cross-domain
AJAX requests and I thought I might share a bit of what I learned.</p>

<ol>
<li><p>jQuery 1.5.0 is BROKEN when it comes to cross-domain AJAX requests.
Upgrade to at least jQuery 1.5.1.</p></li>
<li><p><code>Access-Control-Allow-Origin</code> WON&rsquo;T accept a wildcard value if your
XHR&rsquo;s <code>withCredentials</code> option is set to <code>true</code>. Also, it won&rsquo;t
accept a list of origin. If you want to accept requests from a lot
of domains, you can match the <code>Origin</code> request header against a set
of domains and set the <code>Access-Control-Allow-Origin</code> accordingly.</p></li>
<li><p><code>Access-Control-Allow-Headers</code> and <code>Access-Control-Allow-Methods</code>
CORS header does not support * as a value. You have to be specific,
even during your prototyping phase.</p></li>
</ol>


<p>Hope it helps.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/01/19/a-maintenance-page-served-by-varnish/">Serving a Maintenance Page With Varnish</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-19T00:00:00+01:00" pubdate data-updated="true">Jan 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday during the SOPA Blackout, this website was on strike. The
billions of readers of this blog had a static page explaining why this
website was offline instead of the normal content. As a good nerd, I
turned this operation into a technological one and instead of serving a
static html with nginx, I decided to use
<a href="https://www.varnish-cache.org/">varnish</a>. Yes, varnish. I never wrote
anything about the absolutely amazing architecture of this blog but
basically, static files are generated from
<a href="http://docutils.sourceforge.net/rst.html">RestructuredText</a>, served by
<a href="http://nginx.org/">nginx</a> and cached by varnish. Let&rsquo;s get back to the
point. I wanted varnish to serve a static page with a 503 status code
(for SEO purpose). It took a bit of VCL knowledge and here is how to do
it:</p>

<figure class='code'><figcaption><span>/etc/varnish/maintenance.vcl</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>backend default {
</span><span class='line'>    .host = &quot;127.0.0.1&quot;;
</span><span class='line'>    .port = &quot;8080&quot;;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>sub vcl_recv {
</span><span class='line'>    error 503;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>sub vcl_error {
</span><span class='line'>    set obj.http.Content-Type = &quot;text/html; charset=utf-8&quot;;
</span><span class='line'>    # you can put absolutely what you want
</span><span class='line'>    synthetic {&quot;
</span><span class='line'>        &lt;html&gt;
</span><span class='line'>            &lt;head&gt;
</span><span class='line'>            &lt;title&gt;My maintenance page&lt;/title&gt;
</span><span class='line'>            &lt;/head&gt;
</span><span class='line'>            &lt;body&gt;
</span><span class='line'>            &lt;h1&gt;This website is under maintenance.&lt;/h1&gt;
</span><span class='line'>            &lt;/body&gt;
</span><span class='line'>            &lt;/html&gt;
</span><span class='line'>            &quot;};
</span><span class='line'>    return (deliver);
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>The trick here is the <code>synthetic</code> keyword which is described in the
varnish documentation like this:</p>

<blockquote><p>The synthetic keyword is used to produce a synthetic response body in
<code>vcl_error</code>. It takes a single string as argument.</p></blockquote>

<p>Now that you have a cool VCL for your maintenance page, you can load
this vcl in varnish like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>varnishadm -T 127.0.0.1:6082 -S /etc/varnish/secret <span class="s2">&quot;vcl.load maintenance /etc/varnish/maintenance.vcl&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>and to replace the original rules by those described in maintenance.vcl</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>varnishadm -T 127.0.0.1:6082 -S /etc/varnish/secret <span class="s2">&quot;vcl.use maintenance&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And varnish will serve the maintenance page. Like a boss.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/01/11/php5-postgresql-extension-causing-segfault/">Solving Segfault Issues When Using PHP5 and PostgreSQL</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-11T00:00:00+01:00" pubdate data-updated="true">Jan 11<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If your PHP5 installation always segfault when using PostgreSQL, you
might have to change the loading order of your extensions. To be
specific, you&rsquo;ll surely need to load the postgresql extension before the
curl one.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2012/01/09/simple-feature-flags-symfony2/">Feature Flags With Symfony2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-09T00:00:00+01:00" pubdate data-updated="true">Jan 9<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Feature flags is a really common design in modern web applications and is
heavily used by startups. It permits you to enable/disable features for some
users or groups of users. It&rsquo;s really handy if you want to deploy to production
a feature for testing purpose in order to have data on how your infrastructure
reacts in a live environment.</p>

<p>Let&rsquo;s have some fun and try to implements a simple feature flags design in your
Symfony2 project without writing too much lines of PHP. Sure, we will use the
as complex as powerful Security component for that. I won&rsquo;t dig deep inside it,
so you&rsquo;ll better be well versed about <a href="http://symfony.com/doc/current/book/security.html#roles">roles and roles
hierarchy</a>.</p>

<p>What we want for this project is three types of feature groups: &lsquo;alpha&rsquo;, &lsquo;beta&rsquo;
and &lsquo;prod&rsquo;. I want the admins of my website to have access to the
alpha/unstable features, the beta testing group to the beta features and all
the oser users to all the rest of my application.</p>

<p>We can express this by using role hierarchy:</p>

<figure class='code'><figcaption><span>app/config/security.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">role_hierarchy</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="l-Scalar-Plain">ROLE_ADMIN</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ROLE_USER</span>
</span><span class='line'>        <span class="l-Scalar-Plain">ROLE_SUPER_ADMIN</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">ROLE_USER,ROLE_ADMIN,ROLE_ALLOWED_TO_SWITCH</span>
</span><span class='line'>
</span><span class='line'>        <span class="l-Scalar-Plain">FEATURE_ALPHA</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">FEATURE_BETA, FEATURE_SUPER_SECRET</span>
</span><span class='line'>        <span class="l-Scalar-Plain">FEATURE_BETA</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">FEATURE_PROD, FEATURE_FOOBAR</span>
</span><span class='line'>        <span class="l-Scalar-Plain">FEATURE_PROD</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">FEATURE_FOO, FEATURE_BAR</span>
</span></code></pre></td></tr></table></div></figure>


<p>Thus, anyone whom is granted the <code>FEATURE_ALPHA</code> role will have access to all
the features and the other groups won&rsquo;t have access to the &ldquo;lower&rdquo; features.</p>

<p>This is a rad way of defining who have access to what, but currently,
it&rsquo;s not supported by the SecurityBundle because only roles prefixed by
<code>ROLE_</code> are supported by the current voter.</p>

<p>So, we need to define a new voter that supports the newly created <code>FEATURE_*</code>
roles. Is it complicated? Hell no. Add this to your bundle xml configuration:</p>

<figure class='code'><figcaption><span>Acme/Bundle/AwesomeBundle/Resources/config/config.xml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;service</span> <span class="na">id=</span><span class="s">&quot;awesome.feature_hierarchy.voter&quot;</span> <span class="na">class=</span><span class="s">&quot;%security.access.role_hierarchy_voter.class%&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;argument</span> <span class="na">type=</span><span class="s">&quot;service&quot;</span> <span class="na">id=</span><span class="s">&quot;security.role_hierarchy&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;argument&gt;</span>FEATURE_<span class="nt">&lt;/argument&gt;</span>
</span><span class='line'>    <span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">&quot;security.voter&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;/service&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This simple piece of xml will register a new voter based on the actual role
hierarchy. The difference is that this voter will be specialised in the
<code>FEATURE_</code> prefixed roles.</p>

<p>Now, we need to specify in our user class how the roles will be distributed:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="c1">// You can implement your own logic there, be inventive.</span>
</span><span class='line'><span class="k">public</span> <span class="k">function</span> <span class="nf">getRoles</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isAdmin</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span> <span class="s1">&#39;FEATURE_ALPHA&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isBetaTester</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;ROLE_ADMIN&#39;</span><span class="p">,</span> <span class="s1">&#39;FEATURE_BETA&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;ROLE_USER&#39;</span><span class="p">,</span> <span class="s1">&#39;FEATURE_PROD&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>From now on, the user class will be able to tell wich roles he has, and the
Security context will be able to vote on them. The only thing left to do is to
&ldquo;secure&rdquo; parts of your application.</p>

<p>In your templates:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>
</span><span class='line'>{% if app.security.isGranted(&#39;FEATURE_SUPER_SECRET&#39;)) %}
</span><span class='line'>    {# bla bla bla #}
</span><span class='line'>{% endif %}
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>or in your controllers:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;security.context&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="s1">&#39;FEATURE_SUPER_SECRET&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// do stuff</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>or your routes thanks to the built-in firewall:</p>

<figure class='code'><figcaption><span>app/config/security.yml</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='yaml'><span class='line'><span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
</span><span class='line'>    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
</span><span class='line'>        <span class="p-Indicator">-</span>
</span><span class='line'>            <span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">^/my/route/to/my/feature.*$</span>
</span><span class='line'>            <span class="l-Scalar-Plain">roles</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">FEATURE_SUPER_SECRET</span><span class="p-Indicator">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here we are! You enabled feature flags in your project with a few lines of PHP
and 5 lines of XML. Have fun!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/10/24/back-from-symfony-day-2011-cologne/">Back From SfDay 2011 Cologne</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-24T00:00:00+02:00" pubdate data-updated="true">Oct 24<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m now back to my daily work at SensioLabs after some days spent at
Cologne, mostly for the Symfony Day 2011. It was truly great to be
there. I had the chance to put faces on twitter nicknames and to talk in
front of the crowd. I was a bit nervous and wasn&rsquo;t as relaxed as I would
liked to be. I will try to work on my english pronunciation for the next
times.</p>

<p>Many thanks to the SensioLabs Deutschland &amp; Interlution team, it was
really a nice moment.</p>

<p>Oh, and here are the slides of my talk.</p>

<script src="http://speakerdeck.com/embed/4ea1465e1db551005100f779.js"></script>



</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/01/14/2014-in-music/">2014, my retrospective in music</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/07/">Speechless</a>
      </li>
    
      <li class="post">
        <a href="/2014/12/04/inspirations/">2014&#8217;s inspirations</a>
      </li>
    
      <li class="post">
        <a href="/2014/08/23/in-the-last-24-months/">In the last 24 months</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/15/why-i-stopped-self-hosting-my-stuffs/">Why I Stopped self-hosting my mails, IM and website</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/marcw">@marcw</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'marcw',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license">by-nc-sa - Marc Weistroff</a>. 
  </p>
  <p>
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>, customized with <a href="https://github.com/mjhea0/whiterspace">whiterspace</a>.</span>
</p>
<p><a href="http://internetdefenseleague.org"><img src="http://internetdefenseleague.org/images/badges/final/footer_badge.png" alt="Member of The Internet Defense League" /></a><p>
<script type="text/javascript">
    window._idl = {};
    _idl.variant = "banner";
    (function() {
        var idl = document.createElement('script');
        idl.type = 'text/javascript';
        idl.async = true;
        idl.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'members.internetdefenseleague.org/include/?url=' + (_idl.url || '') + '&campaign=' + (_idl.campaign || '') + '&variant=' + (_idl.variant || 'banner');
        document.getElementsByTagName('body')[0].appendChild(idl);
    })();
</script>

</footer>
  











</body>
</html>
